{"meta":{"source_url":"https://github.com/quic/efficient-transformers/tree/main","owner":"quic","repo":"efficient-transformers","branch":"main","subpath":"","created_at":"2025-09-11T07:35:47Z","graph_id":"e472daf5ae36","totals":{"files":255,"classes":277,"functions":385,"imports":1146},"shard":"tests"},"dicts":{"imports":["QEfficient.utils.constants","QEfficient.utils.logging_utils","QEfficient.utils.test_utils","json","os","pytest","shutil","transformers","QEfficient.utils.hash_utils","random","QEfficient.peft.onnx_transforms","onnx","textwrap","QEfficient","numpy","peft","time","torch","QEfficient.peft.lora","QEfficient.utils","pathlib","QEfficient.generation.text_generation_inference","QEfficient.transformers.models.modeling_auto","QEfficient.utils._utils","QEfficient.utils.device_utils","vllm","QEfficient.customop.matmulnbits","QEfficient.transformers.models.pytorch_transforms","QEfficient.transformers.quantizers.awq","QEfficient.transformers.quantizers.gptq","QEfficient.transformers.quantizers.quant_transforms","QEfficient.transformers.spd.turbo","platform","transformers.cache_utils","copy","QEfficient.generation.cloud_infer","typing","dataclasses","QEfficient.transformers.embeddings.embedding_utils","onnxruntime","QEfficient.exporter.export_hf_to_cloud_ai_100","QEfficient.transformers.quantizers.auto","QEfficient.utils.run_utils","PIL","io","requests","datasets","importlib","QEfficient.cloud.finetune","QEfficient.finetune.utils.helper","tests.finetune","torch.optim","torch.utils.data","QEfficient.base.pytorch_transforms","QEfficient.base.onnx_transforms","QEfficient.base.modeling_qeff","types","QEfficient.cloud.infer","QEfficient.cloud.execute","QEfficient.cloud.export","yaml","QEfficient.base","QEfficient.compile.compile_helper","QEfficient.peft","QEfficient.transformers.transform","QEfficient.utils.model_registery","qaicrt","sys","warnings","safetensors.torch","logging","QEfficient.utils.generate_inputs","QEfficient.transformers.modeling_utils","huggingface_hub","QEfficient.transformers.models.llama_swiftkv.modeling_llama_swiftkv","math","re","subprocess","torch.nn","torchvision.transforms","torchvision.transforms.functional","hashlib","QEfficient.utils.cache","inspect","requests.exceptions","xml.etree.ElementTree","QEfficient.peft.peft_model","QEfficient.peft.pytorch_transforms","transformers.generation.streamers","QEfficient.peft.auto","QEfficient.peft.lora.layers","QEfficient.peft.lora.lora_model","QEfficient.transformers.models.llama.modeling_llama","QEfficient.transformers.models.mistral.modeling_mistral","QEfficient.peft.lora.pytorch_transforms","QEfficient.peft.lora.auto","transformers.modeling_outputs","QEfficient.customop","torch.nn.functional","onnxscript","QEfficient.customop.ctx_scatter_gather","QEfficient.customop.ctx_scatter_gather_cb","QEfficient.customop.rms_norm","collections","QAicApi_pb2","QEfficient.utils.spd_utils","QEfficient.transformers.cache_utils","models.codegen.modeling_codegen","models.falcon.modeling_falcon","models.gemma.modeling_gemma","models.gemma2.modeling_gemma2","models.gpt2.modeling_gpt2","models.gpt_bigcode.modeling_gpt_bigcode","models.gptj.modeling_gptj","models.llama.modeling_llama","models.mistral.modeling_mistral","models.mixtral_moe.modeling_mixtral","models.mpt.modeling_mpt","models.phi.modeling_phi","models.phi3.modeling_phi3","models.qwen2.modeling_qwen2","models.starcoder2.modeling_starcoder2","models.whisper.modeling_whisper","transformers.models.auto.modeling_auto","transformers.models.codegen.modeling_codegen","transformers.models.falcon.modeling_falcon","transformers.models.gemma.modeling_gemma","transformers.models.gemma2.modeling_gemma2","transformers.models.gpt2.modeling_gpt2","transformers.models.gpt_bigcode.modeling_gpt_bigcode","transformers.models.gptj.modeling_gptj","transformers.models.llama.modeling_llama","transformers.models.mistral.modeling_mistral","transformers.models.mixtral.modeling_mixtral","transformers.models.mllama.modeling_mllama","transformers.models.mpt.modeling_mpt","transformers.models.phi.modeling_phi","transformers.models.phi3.modeling_phi3","transformers.models.qwen2.modeling_qwen2","transformers.models.starcoder2.modeling_starcoder2","transformers.models.whisper.modeling_whisper","QEfficient.utils.checkpoint_utils","QEfficient.transformers.quantizers.quantizer_compressed_tensors","QEfficient.transformers.quantizers.quantizer_utils","QEfficient.transformers.quantizers.quantizer_awq","QEfficient.transformers.quantizers.quantizer_gptq","transformers.quantizers.auto","transformers.quantizers.quantizer_awq","transformers.quantizers.quantizer_compressed_tensors","transformers.quantizers.quantizer_gptq","transformers.utils.quantization_config","transformers.integrations.awq","enum","transformers.quantizers","QEfficient.transformers.models.codegen.modeling_codegen","QEfficient.transformers.models.falcon.modeling_falcon","QEfficient.transformers.models.gemma.modeling_gemma","QEfficient.transformers.models.gemma2.modeling_gemma2","QEfficient.transformers.models.gemma3.modeling_gemma3","QEfficient.transformers.models.gpt2.modeling_gpt2","QEfficient.transformers.models.gpt_bigcode.modeling_gpt_bigcode","QEfficient.transformers.models.gptj.modeling_gptj","QEfficient.transformers.models.granite.modeling_granite","QEfficient.transformers.models.granitemoe.modeling_granitemoe","QEfficient.transformers.models.grok_1.modeling_grok1","QEfficient.transformers.models.internvl.modeling_internvl","QEfficient.transformers.models.llama4.modeling_llama4","QEfficient.transformers.models.llava.modeling_llava","QEfficient.transformers.models.llava_next.modeling_llava_next","QEfficient.transformers.models.mixtral_moe.modeling_mixtral","QEfficient.transformers.models.mllama.modeling_mllama","QEfficient.transformers.models.mpt.modeling_mpt","QEfficient.transformers.models.phi.modeling_phi","QEfficient.transformers.models.phi3.modeling_phi3","QEfficient.transformers.models.qwen2.modeling_qwen2","QEfficient.transformers.models.starcoder2.modeling_starcoder2","QEfficient.transformers.models.whisper.modeling_whisper","QEfficient.transformers.post_processing","QEfficient.transformers.sampler.sampler","QEfficient.transformers.spd.spd_transform_forward","transformers.models.gemma3.modeling_gemma3","transformers.models.granite.modeling_granite","transformers.models.granitemoe.modeling_granitemoe","transformers.models.llama4.modeling_llama4","transformers.models.llava.modeling_llava","transformers.models.llava_next.modeling_llava_next","QEfficient.transformers.modeling_attn_mask_utils","torch.utils.checkpoint","transformers.modeling_attn_mask_utils","transformers.modeling_utils","transformers.generation","transformers.utils.import_utils","transformers.modeling_rope_utils","QEfficient.utils.generate_qnn_network_specialization_config","QEfficient.compile.qnn_compiler","QEfficient.finetune.configs.training","QEfficient.finetune.utils.logging_utils","fire","torch_qaic","utils.config_utils","utils.dataset_utils","utils.train_utils","itertools","contextlib","torch.amp","torch.qaic.amp","torch_qaic.debug","torch_qaic.profile","datetime","QEfficient.finetune.data.sampler","QEfficient.finetune.dataset.dataset_config","torch.distributed","transformers.data","argparse","matplotlib.pyplot","functools","torch.utils.tensorboard","torchmetrics","tqdm","QEfficient.finetune.configs.dataset_config","QEfficient.finetune.configs.peft_config","QEfficient.finetune.dataset.alpaca_dataset","QEfficient.finetune.dataset.custom_dataset","QEfficient.finetune.dataset.grammar_dataset","QEfficient.finetune.dataset.gsm8k_dataset","QEfficient.finetune.dataset.imdb_dataset","QEfficient.base.common","QEfficient.exporter.export_utils","abc","gc","QEfficient.finetune.utils.config_utils","QEfficient.finetune.utils.dataset_utils","QEfficient.finetune.utils.device_map","QEfficient.finetune.utils.parser","QEfficient.finetune.utils.train_utils","torch.optim.lr_scheduler","InferenceSetIOBuffer"]},"files":[{"path":"tests/README.md","lang":"text","classes":[],"functions":[],"imports":[]},{"path":"tests/conftest.py","lang":"python","classes":[],"functions":["custom_causal_model_config_dict","get_custom_model_config_dict","pytest_sessionfinish","pytest_sessionstart","qeff_models_clean_up"],"imports":[0,1,2,3,4,5,6,7]},{"path":"tests/__init__.py","lang":"python","classes":[],"functions":[],"imports":[]},{"path":"tests/utils/test_hash_utils.py","lang":"python","classes":[],"functions":["get_random_string","test_hash_dict_params","test_json_serializable","test_to_hashable","test_to_hashable_dict","test_to_hashable_float_nan","test_to_hashable_set"],"imports":[0,8,3,5,9]},{"path":"tests/peft/test_peft_onnx_transforms.py","lang":"python","classes":[],"functions":["test_adapter_weights_to_inputs_transform"],"imports":[10,11,12]},{"path":"tests/peft/test_peft_model.py","lang":"python","classes":[],"functions":["create_peft_model","test_auto_peft_model_for_causal_lm_activate_invalid","test_auto_peft_model_for_causal_lm_compile_generate","test_auto_peft_model_for_causal_lm_export","test_auto_peft_model_for_causal_lm_from_pretrained","test_auto_peft_model_for_causal_lm_hash","test_auto_peft_model_for_causal_lm_init"],"imports":[13,14,11,4,15,5,16,17,7]},{"path":"tests/peft/lora/test_lora_model.py","lang":"python","classes":[],"functions":["create_lora_base_model","test_auto_lora_model_for_causal_lm_cb_compile_generate","test_auto_lora_model_for_causal_lm_from_pretrained","test_auto_lora_model_for_causal_lm_hash","test_auto_lora_model_for_causal_lm_init","test_auto_lora_model_for_causal_lm_init_from_unsupported_model","test_auto_lora_model_for_causal_lm_load_unload_adapter","test_auto_lora_model_for_causal_lm_noncb_export_compile_generate","test_auto_peft_model_for_causal_lm_from_pretrained"],"imports":[13,18,19,14,4,20,15,5,16,7]},{"path":"tests/text_generation/test_text_generation.py","lang":"python","classes":[],"functions":["load_causal_lm_model","test_generate_text_stream"],"imports":[21,22,19,23,0,24,4,5,7]},{"path":"tests/vllm/test_qaic_output_consistency.py","lang":"python","classes":[],"functions":["test_output_consistency"],"imports":[5,9,25]},{"path":"tests/transformers/test_transformer_pytorch_transforms.py","lang":"python","classes":[],"functions":["compare_original_vs_kv_model_pt_outputs","create_qaic_model_inputs","run_kv_cache_transform_and_test","test_awq_to_matmulnbits_transform","test_gptq_to_matmulnbits_transform","test_kv_cache_transform","test_rms_norm_ops_transform","test_spd_proj_transform","test_spd_transform"],"imports":[26,22,27,28,29,30,31,23,1,32,5,17,7,33]},{"path":"tests/transformers/test_speech_seq2seq.py","lang":"python","classes":[],"functions":["test_causal_lm_compile","test_seq2seq_export_and_hash","test_seq2seq_hash_creation","test_seq2seq_init","test_seq2seq_pretrained","test_seq2seq_unsupported","tmp_cache"],"imports":[22,8,34,11,4,5,16,7]},{"path":"tests/transformers/test_causal_lm.py","lang":"python","classes":[],"functions":["test_causal_lm_compile","test_causal_lm_export_and_hash","test_causal_lm_hash_creation","test_causal_lm_init","test_causal_lm_pretrained","test_causal_lm_unsupported","tmp_cache"],"imports":[22,19,8,34,11,4,5,16,7]},{"path":"tests/transformers/spd/test_spd_inference.py","lang":"python","classes":[],"functions":["get_padded_input_len","run_prefill_on_draft_and_target","split_dlm_bonus_token_inputs","test_spec_decode_inference"],"imports":[13,35,0,24,14,4,5,16,7,36]},{"path":"tests/transformers/spd/test_pld_inference.py","lang":"python","classes":["CloudAI100ExecInfo","PerfMetrics"],"functions":["find_candidate_pred_tokens","get_padded_input_len","run_prefill_on_draft_and_target","test_pld_spec_decode_inference"],"imports":[13,35,0,24,37,14,5,16,7,36]},{"path":"tests/transformers/models/test_embedding_models.py","lang":"python","classes":[],"functions":["check_embed_pytorch_vs_ort_vs_ai100","test_embed_model_pytorch_vs_onnx_vs_ai100","test_embed_model_pytorch_vs_onnx_vs_ai100_multiple_seq_len","test_embed_model_pytorch_vs_onnx_vs_ai100_multiple_seq_len_qnn","test_embed_model_pytorch_vs_onnx_vs_ai100_pooling","test_embed_model_pytorch_vs_onnx_vs_ai100_pooling_qnn","test_embed_model_pytorch_vs_onnx_vs_ai100_qnn"],"imports":[38,22,23,0,14,39,4,5,17,7,36]},{"path":"tests/transformers/models/custom_tiny_model_configs.json","lang":"text","classes":[],"functions":[],"imports":[]},{"path":"tests/transformers/models/test_causal_lm_models.py","lang":"python","classes":[],"functions":["check_causal_lm_pytorch_vs_kv_vs_ort_vs_ai100","get_custom_n_layers","load_causal_lm_model","test_causal_lm_export_with_deprecated_api","test_causal_lm_pytorch_vs_kv_vs_ort_vs_ai100","test_causal_lm_pytorch_vs_kv_vs_ort_vs_ai100_pl1","test_causal_lm_pytorch_vs_kv_vs_ort_vs_ai100_pl1_qnn","test_causal_lm_pytorch_vs_kv_vs_ort_vs_ai100_qnn","test_causal_tlm_pytorch_vs_kv_vs_ort_vs_ai100","test_custom_causal_lm_pytorch_vs_kv_vs_ort_vs_ai100","test_custom_causal_lm_pytorch_vs_kv_vs_ort_vs_ai100_qnn","test_custom_causal_tlm_pytorch_vs_kv_vs_ort_vs_ai100","test_prefiill_only_pytorch_vs_kv_vs_ort_vs_ai100","test_prefiill_only_pytorch_vs_kv_vs_ort_vs_ai100_qnn"],"imports":[40,22,41,19,23,0,24,42,2,34,14,4,5,17,7,36]},{"path":"tests/transformers/models/test_image_text_to_text_models.py","lang":"python","classes":[],"functions":["check_image_text_to_text_pytorch_vs_kv_vs_ort_vs_ai100","check_intern_image_text_to_text_pytorch_vs_kv_vs_ort_vs_ai100","load_image_text_to_text_model","set_num_layers","test_image_text_to_text_intern_pytorch_vs_kv_vs_ort_vs_ai100","test_image_text_to_text_intern_pytorch_vs_kv_vs_ort_vs_ai100_qnn","test_image_text_to_text_pytorch_vs_kv_vs_ort_vs_ai100","test_image_text_to_text_pytorch_vs_kv_vs_ort_vs_ai100_qnn"],"imports":[43,22,19,23,0,24,42,2,44,4,5,45,17,7,36]},{"path":"tests/transformers/models/test_prefix_caching.py","lang":"python","classes":[],"functions":["prefix_caching_inference","test_simple_prefix_caching","test_simple_prefix_caching_qnn"],"imports":[21,22,23,0,14,4,5,7]},{"path":"tests/transformers/models/test_speech_seq2seq_models.py","lang":"python","classes":[],"functions":["check_seq2seq_pytorch_vs_kv_vs_ort_vs_ai100","load_seq2seq_model","run_seq2seq_ort","run_seq2seq_pytorch_hf","run_seq2seq_pytorch_with_kv","test_seq2seq_pytorch_vs_kv_vs_ort_vs_ai100","test_seq2seq_pytorch_vs_kv_vs_ort_vs_ai100_qnn"],"imports":[22,41,19,23,0,24,46,47,14,11,39,4,5,17,7,36]},{"path":"tests/finetune/reference_data.py","lang":"python","classes":[],"functions":[],"imports":[]},{"path":"tests/finetune/constants.py","lang":"python","classes":[],"functions":[],"imports":[]},{"path":"tests/finetune/test_finetune.py","lang":"python","classes":[],"functions":["assert_list_close","clean_up","download_alpaca","test_finetune"],"imports":[13,48,49,14,4,5,45,6,50,51,52]},{"path":"tests/base/test_pytorch_transforms.py","lang":"python","classes":["TestModel","TestTransform"],"functions":["test_module_mapping_transform","test_module_mutator_transform"],"imports":[53,5,17]},{"path":"tests/base/test_onnx_transforms.py","lang":"python","classes":[],"functions":["test_fp16clip_transform","test_fp16clip_transform_external","test_split_tensors_transform"],"imports":[54,14,11]},{"path":"tests/base/test_modeling_qeff.py","lang":"python","classes":[],"functions":["test_compiler_invalid_file","test_compiler_invalid_flag"],"imports":[55,11,5,56]},{"path":"tests/base/test_export_memory_offload.py","lang":"python","classes":["MockLangModel","MockModel","MockParam","MockSingleQPCModel","MockVisionModel"],"functions":["test_offload_weights_method","test_re_export_behavior_with_offloaded_weights","test_vlm_dual_qpc_memory_offload_behavior","test_vlm_single_qpc_memory_offload_behavior","tmp_cache"],"imports":[22,4,5,7]},{"path":"tests/cloud/test_infer.py","lang":"python","classes":[],"functions":["check_infer","test_infer","test_infer_fbs","test_infer_qnn","test_infer_qnn_fbs","test_infer_vlm"],"imports":[13,57,5]},{"path":"tests/cloud/test_export_compile_execute.py","lang":"python","classes":[],"functions":["check_export_compile_execute","test_export_compile_execute","test_export_compile_execute_fbs","test_export_compile_execute_qnn","test_export_compile_execute_qnn_fbs"],"imports":[13,58,59,4,5,60]}]}